for (i in 1:nrow(data_virus_4_1)){
rsq(as.numeric(data_virus_4_1[i,]), varIAPV)
}
for (i in 1:nrow(data_virus_4_1)){
print(rsq(as.numeric(data_virus_4_1[i,]), varIAPV))
}
RSQ_VIRUS_4_1 = c()
RSQ_virus_4_1 = c()
for (i in 1:nrow(data_virus_4_1)){
RSQ_virus_4_1[i] = rsq(as.numeric(data_virus_4_1[i,]), varIAPV)
}
RSQ_virus_4_1
sort(RSQ_virus_4_1)
summary(RSQ_virus_4_1)
virus_4_1 <- readRDS("../N_V/DESeq2/ClusterStandard/Sig_4_1.Rds") #28
virus_4_2 <- readRDS("../N_V/DESeq2/ClusterStandard/Sig_4_2.Rds") #28
virus_4_3 <- readRDS("../N_V/DESeq2/ClusterStandard/Sig_4_3.Rds") #28
virus_4_4 <- readRDS("../N_V/DESeq2/ClusterStandard/Sig_4_4.Rds") #28
RSQ_virus_4_2 = c()
for (i in 1:nrow(data_virus_4_2)){
RSQ_virus_4_2[i] = rsq(as.numeric(data_virus_4_2[i,]), varIAPV)
}
data_virus_4_2 <- data[which(rownames(data) %in% virus_4_2),]
data_virus_4_3 <- data[which(rownames(data) %in% virus_4_3),]
data_virus_4_4 <- data[which(rownames(data) %in% virus_4_4),]
RSQ_virus_4_2 = c()
for (i in 1:nrow(data_virus_4_2)){
RSQ_virus_4_2[i] = rsq(as.numeric(data_virus_4_2[i,]), varIAPV)
}
RSQ_virus_4_3 = c()
for (i in 1:nrow(data_virus_4_3)){
RSQ_virus_4_3[i] = rsq(as.numeric(data_virus_4_3[i,]), varIAPV)
}
RSQ_virus_4_4 = c()
for (i in 1:nrow(data_virus_4_4)){
RSQ_virus_4_4[i] = rsq(as.numeric(data_virus_4_4[i,]), varIAPV)
}
RSQ_virus_4_2
sotr(RSQ_virus_4_2)
sort(RSQ_virus_4_2)
summary(RSQ_virus_4_2)
summary(RSQ_virus_4_3)
summary(RSQ_virus_4_4)
virus_4 = list()
for (i in 1:4){
virus_4[[i]] <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
}
data_virus_4 = list()
RSQ_virus_4 = list()
for (i in 1:4){
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
RSQ_virus_4[[i]] <- rsq(as.numeric(temp2[i,]), varIAPV)
}
RSQ_virus_4
RSQ_virus_4[[1]]
RSQ_virus_4[[2]]
i=1
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp2
RSQ_virus_4 = list()
for (i in 1:4){
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (i in 1:nrow(data_virus_4_4)){
temp3[i] <- rsq(as.numeric(temp2[i,]), varIAPV)
}
RSQ_virus_4[[i]] <- temp3
}
RSQ_virus_4
RSQ_virus_4 = list()
for (i in 1:4){
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(data_virus_4_4)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
RSQ_virus_4[[i]] <- temp3
}
RSQ_virus_4
i=1
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp2
str(temp2)
nrow(temp2)
RSQ_virus_4 = list()
for (i in 1:4){
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
RSQ_virus_4[[i]] <- temp3
}
RSQ_virus_4
rm(list=ls())
#data <- as.data.frame(readRDS("../N_V/data/data.Rds"))
data <- as.data.frame(readRDS("../NC_NR_VC_VR/data/data.Rds"))
rm(list=ls())
rsq <- function (x, y) cor(x, y) ^ 2
Variables <- read_csv("~/HoneyBeePaper/Variables.csv")
varIAPV <- as.data.frame(Variables[,7])[,1]
RSQ_virus_4 = list()
for (i in 1:4){
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
RSQ_virus_4[[i]] <- temp3
}
RSQ_virus_4 = list()
i=1
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
#data <- as.data.frame(readRDS("../N_V/data/data.Rds"))
data <- as.data.frame(readRDS("../NC_NR_VC_VR/data/data.Rds"))
getwd()
RSQ_tolerance_4 = list()
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Tolerance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
RSQ_tolerance_4[[i]] <- temp3
}
summary(RSQ_tolerance[[1]])
summary(RSQ_tolerance_4[[1]])
summary(RSQ_tolerance_4[[2]])
summary(RSQ_tolerance_4[[3]])
summary(RSQ_tolerance_4[[4]])
RSQ_resistance_4 = list()
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Resistance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
RSQ_resistance_4[[i]] <- temp3
}
summary(RSQ_resistance_4[[1]])
summary(RSQ_resistance_4[[2]])
summary(RSQ_resistance_4[[3]])
summary(RSQ_resistance_4[[4]])
str(data)
RSQ_data = list()
for (i in 1:4){
#temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Resistance/Sig_4_", i, ".Rds"))
temp2 <- data#[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
RSQ_data[[i]] <- temp3
}
summary(RSQ_data)
RSQ_data = list()
RSQ_data = c()
for (i in 1:nrow(data)){
RSQ_data[i] <- rsq(as.numeric(data[i,]), varIAPV)
}
str(RSQ_data)
RSQ_data
head(RSQ_data)
as.numeric(data[2,])
data[2,]
summary(RSQ_data)
setwd("~/HoneyBeePaper/MortalityData")
rm(list=ls())
d <- read_csv("day3Mortality.csv")
d = as.data.frame(d)
attr(d, "spec") <- NULL
# Note: There are 14 NC; 15 VR, VC, NR
d = d[which(d$Treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$Treatment
d$Treatment = as.factor(d$Treatment)
colnames(d)[3] = "Day3Mortality"
levels(d$Treatment) <- c('NC', 'NR', 'VC', 'VR')
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
str(d)
plotMortality = ggplot(d, aes(x=Treatment, y=Day3Mortality)) + geom_boxplot(fill="palegreen2") + geom_text(data = labelDF, aes(x = plot.labels, y = V1, label = labels)) + ylab("Day 3 Mortality Rate") + theme_gray() + ylim(0,0.8)
# Mortality (All)
labelDF = data.frame(plot.labels=c("NR","VC","VR","NC"), labels = c("ab","bc","c","a"), V1 = c(0.22, 0.479, 0.793, 0.164))
plotMortality = ggplot(d, aes(x=Treatment, y=Day3Mortality)) + geom_boxplot(fill="palegreen2") + geom_text(data = labelDF, aes(x = plot.labels, y = V1, label = labels)) + ylab("Day 3 Mortality Rate") + theme_gray() + ylim(0,0.8)
plotMortality
dev.off()
dev.off()
setwd("~/HoneyBeePaper/ResistanceTolerance")
rm(list=ls())
#data <- as.data.frame(readRDS("../N_V/data/data.Rds"))
data <- as.data.frame(readRDS("../NC_NR_VC_VR/data/data.Rds"))
rsq <- function (x, y) cor(x, y) ^ 2
Variables <- read_csv("~/HoneyBeePaper/Variables.csv")
varIAPV <- as.data.frame(Variables[,7])[,1]
RSQ_virus_4 = list()
for (i in 1:4){
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
RSQ_virus_4[[i]] <- temp3
}
RSQ_tolerance_4 = list()
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Tolerance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
RSQ_tolerance_4[[i]] <- temp3
}
RSQ_resistance_4 = list()
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Resistance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
RSQ_resistance_4[[i]] <- temp3
}
RSQ_data = c()
for (i in 1:nrow(data)){
RSQ_data[i] <- rsq(as.numeric(data[i,]), varIAPV)
}
ls()
str(RSQ_data)
which(is.na(RSQ_data))
length(which(is.na(RSQ_data)))
summary(RSQ_data)
str(RSQ_data)
RSQ_data <- RSQ_data[-which(is.na(RSQ_data))]
str(RSQ_data)
15314-13888
ls()
rm(list=ls())
#data <- as.data.frame(readRDS("../N_V/data/data.Rds"))
data <- as.data.frame(readRDS("../NC_NR_VC_VR/data/data.Rds"))
rsq <- function (x, y) cor(x, y) ^ 2
Variables <- read_csv("~/HoneyBeePaper/Variables.csv")
varIAPV <- as.data.frame(Variables[,7])[,1]
boxVirus <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(df) <- c("Group", "R2")
colnames(boxVirus) <- c("Group", "R2")
i=1
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
rep(10,"h")
rep("h",10)
boxVirus <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxVirus) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
#RSQ_virus_4[[i]] <- temp3
boxVirus <- rbind(boxVirus, data.frame(Group = rep(paste0("virus",i), length(temp3)), R2 = temp3))
}
View(boxVirus)
boxTolerance <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxVirus) <- c("Group", "R2")
boxTolerance <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxVirus) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Tolerance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
boxTolerance <- rbind(boxTolerance, data.frame(Group = rep(paste0("tolerance",i), length(temp3)), R2 = temp3))
}
rm(list=ls())
dev.off()
library(readr)
#data <- as.data.frame(readRDS("../N_V/data/data.Rds"))
data <- as.data.frame(readRDS("../NC_NR_VC_VR/data/data.Rds"))
rsq <- function (x, y) cor(x, y) ^ 2
Variables <- read_csv("~/HoneyBeePaper/Variables.csv")
varIAPV <- as.data.frame(Variables[,7])[,1]
RSQ_virus_4 = data.frame()
rm(RSQ_virus_4)
boxVirus <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxVirus) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
boxVirus <- rbind(boxVirus, data.frame(Group = rep(paste0("virus",i), length(temp3)), R2 = temp3))
}
boxTolerance <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxTolerance) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Tolerance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
boxTolerance <- rbind(boxTolerance, data.frame(Group = rep(paste0("tolerance",i), length(temp3)), R2 = temp3))
}
boxResistance <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxResistance) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Resistance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
boxResistance <- rbind(boxResistance, data.frame(Group = rep(paste0("resistance",i), length(temp3)), R2 = temp3))
}
boxData <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxData) <- c("Group", "R2")
for (i in 1:nrow(data)){
temp3 <- rsq(as.numeric(data[i,]), varIAPV)
}
boxData <- rbind(boxData, data.frame(Group = rep(paste0("data",i), length(temp3)), R2 = temp3))
ls()
str(boxData)
str(boxResistance)
str(boxTolernace)
str(boxTolerance)
str(boxVirus)
boxData <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxData) <- c("Group", "R2")
for (i in 1:nrow(data)){
temp3 <- rsq(as.numeric(data[i,]), varIAPV)
}
str(temp3)
str(data)
str(temp3)
nrow(data)
for (i in 1:nrow(data)){
temp3[i] <- rsq(as.numeric(data[i,]), varIAPV)
}
str(temp3)
temp3 <- temp3[-which(is.na(temp3))]
str(temp3)
boxData <- rbind(boxData, data.frame(Group = rep(paste0("data",i), length(temp3)), R2 = temp3))
str(boxData)
boxData <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxData) <- c("Group", "R2")
for (i in 1:nrow(data)){
temp3[i] <- rsq(as.numeric(data[i,]), varIAPV)
}
temp3 <- temp3[-which(is.na(temp3))]
boxData <- rbind(boxData, data.frame(Group = rep(paste0("data"), length(temp3)), R2 = temp3))
str(boxData)
head(boxData)
ls()
plotVirus = rbind(boxVirus, boxData)
str(plotVirus)
ggplot(plotVirus, aes(x=Group, y=R2)) + geom_boxplot(fill="palegreen2")
plotTolerance = rbind(plotTolerance, boxData)
plotTolerance = rbind(boxTolerance, boxData)
ggplot(plotTolerance, aes(x=Group, y=R2)) + geom_boxplot(fill="palegreen2")
plotResistance = rbind(boxResistance, boxData)
ggplot(plotResistance, aes(x=Group, y=R2)) + geom_boxplot(fill="palegreen2")
dev.off()
dev.off()
rm(list=ls())
#data <- as.data.frame(readRDS("../N_V/data/data.Rds"))
data <- as.data.frame(readRDS("../NC_NR_VC_VR/data/data.Rds"))
# Normalize for sequencing depth and other distributional differences between lanes
data <- betweenLaneNormalization(as.matrix(data), which="full", round=FALSE)
data = as.data.frame(data)
rsq <- function (x, y) cor(x, y) ^ 2
Variables <- read_csv("~/HoneyBeePaper/Variables.csv")
varIAPV <- as.data.frame(Variables[,7])[,1]
boxVirus <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxVirus) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
boxVirus <- rbind(boxVirus, data.frame(Group = rep(paste0("virus",i), length(temp3)), R2 = temp3))
}
boxTolerance <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxTolerance) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Tolerance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
boxTolerance <- rbind(boxTolerance, data.frame(Group = rep(paste0("tolerance",i), length(temp3)), R2 = temp3))
}
boxResistance <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxResistance) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Resistance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
boxResistance <- rbind(boxResistance, data.frame(Group = rep(paste0("resistance",i), length(temp3)), R2 = temp3))
}
boxData <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxData) <- c("Group", "R2")
for (i in 1:nrow(data)){
temp3[i] <- rsq(as.numeric(data[i,]), varIAPV)
}
temp3 <- temp3[-which(is.na(temp3))]
boxData <- rbind(boxData, data.frame(Group = rep(paste0("data"), length(temp3)), R2 = temp3))
plotVirus = rbind(boxVirus, boxData)
ggplot(plotVirus, aes(x=Group, y=R2)) + geom_boxplot(fill="palegreen2")
plotTolerance = rbind(boxTolerance, boxData)
ggplot(plotTolerance, aes(x=Group, y=R2)) + geom_boxplot(fill="palegreen2")
plotResistance = rbind(boxResistance, boxData)
ggplot(plotResistance, aes(x=Group, y=R2)) + geom_boxplot(fill="palegreen2")
dev.off()
rm(list=ls())
#data <- as.data.frame(readRDS("../N_V/data/data.Rds"))
data <- as.data.frame(readRDS("../NC_NR_VC_VR/data/data.Rds"))
# Another approach?
data <- as.matrix(data)
coldata = data.frame(row.names = colnames(data), treatment = unlist(lapply(colnames(data), function (x) unlist(strsplit(x, "[.]"))[1])))
dds = DESeqDataSetFromMatrix(countData = data, colData = coldata, design = ~ treatment)
library(DESeq2)
dds = DESeqDataSetFromMatrix(countData = data, colData = coldata, design = ~ treatment)
dds <- DESeq(dds)
str(dds)
str(dds[[1]])
rm(list=ls())
#data <- as.data.frame(readRDS("../N_V/data/data.Rds"))
data <- as.data.frame(readRDS("../NC_NR_VC_VR/data/data.Rds"))
str(data)
# Next lines for logging
data <- log(data+1)
str(data)
rsq <- function (x, y) cor(x, y) ^ 2
Variables <- read_csv("~/HoneyBeePaper/Variables.csv")
varIAPV <- as.data.frame(Variables[,7])[,1]
boxVirus <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxVirus) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../N_V/DESeq2/ClusterStandard/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
boxVirus <- rbind(boxVirus, data.frame(Group = rep(paste0("virus",i), length(temp3)), R2 = temp3))
}
boxTolerance <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxTolerance) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Tolerance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
boxTolerance <- rbind(boxTolerance, data.frame(Group = rep(paste0("tolerance",i), length(temp3)), R2 = temp3))
}
boxResistance <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxResistance) <- c("Group", "R2")
for (i in 1:4){
temp <- readRDS(paste0("../ResistanceTolerance/Clustering_Resistance/Sig_4_", i, ".Rds"))
temp2 <- data[which(rownames(data) %in% temp),]
temp3 = c()
for (j in 1:nrow(temp2)){
temp3[j] <- rsq(as.numeric(temp2[j,]), varIAPV)
}
boxResistance <- rbind(boxResistance, data.frame(Group = rep(paste0("resistance",i), length(temp3)), R2 = temp3))
}
boxData <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(boxData) <- c("Group", "R2")
for (i in 1:nrow(data)){
temp3[i] <- rsq(as.numeric(data[i,]), varIAPV)
}
temp3 <- temp3[-which(is.na(temp3))]
boxData <- rbind(boxData, data.frame(Group = rep(paste0("data"), length(temp3)), R2 = temp3))
plotVirus = rbind(boxVirus, boxData)
ggplot(plotVirus, aes(x=Group, y=R2)) + geom_boxplot(fill="palegreen2")
plotTolerance = rbind(boxTolerance, boxData)
ggplot(plotTolerance, aes(x=Group, y=R2)) + geom_boxplot(fill="palegreen2")
plotResistance = rbind(boxResistance, boxData)
ggplot(plotResistance, aes(x=Group, y=R2)) + geom_boxplot(fill="palegreen2")
dev.off()
dev.off()
