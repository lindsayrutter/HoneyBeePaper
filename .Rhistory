anova(mortcomp)
anova(mortcomp2)
??aov
??aov
anova(model)
rm(list=ls())
d <- read_csv("day3Mortality.csv")
d = as.data.frame(d)
attr(d, "spec") <- NULL
# Note: There are 14 NC; 15 VR, VC, NR
d = d[which(d$Treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$Treatment
d$Treatment = as.factor(d$Treatment)
colnames(d)[3] = "Day3Mortality"
levels(d$Treatment) <- c('NC', 'NR', 'VC', 'VR')
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
# Mortality (All)
model<-aov(Day3Mortality~Treatment, data=d)
anova(model)
# Mortality (R vs C)
model<-aov(Day3Mortality~Diet, data=d)
anova(model)
out <- LSD.test(model,"Diet", p.adj="bonferroni")
# Variation range: max and min
plot(out, ylab="Mortality")
# Used to print the actual p-values
pvals <- LSD.test(model,"Diet", p.adj="bonferroni", group=FALSE)
pvals
dev.off()
rm(list=ls())
d <- read_csv("day3Mortality.csv")
d = as.data.frame(d)
attr(d, "spec") <- NULL
# Note: There are 14 NC; 15 VR, VC, NR
d = d[which(d$Treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$Treatment
d$Treatment = as.factor(d$Treatment)
colnames(d)[3] = "Day3Mortality"
levels(d$Treatment) <- c('NC', 'NR', 'VC', 'VR')
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
# Mortality (All)
model<-aov(Day3Mortality~Treatment, data=d)
out <- LSD.test(model,"Treatment", p.adj="bonferroni")
anova(model)
# Used to print the actual p-values
pvals <- LSD.test(model,"Treatment", p.adj="bonferroni", group=FALSE)
pvals
# Mortality (N vs V)
model<-aov(Day3Mortality~Virus, data=d)
anova(model)
# Mortality (R vs C)
model<-aov(Day3Mortality~Diet, data=d)
# Used to print the actual p-values
pvals <- LSD.test(model,"Diet", p.adj="bonferroni", group=FALSE)
pvals
anova(model)
# Mortality (All)
model<-aov(Day3Mortality~Treatment, data=d)
# Used to print the actual p-values
anova(model)
rm(list=ls())
dev.off()
d <- read_delim("logIAPV.csv", "\t", escape_double = FALSE, trim_ws = TRUE)
d = as.data.frame(d)
attr(d, "spec") <- NULL
d = d[which(d$treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$treatment = as.factor(d$treatment)
colnames(d)[3] = "logIAPV"
levels(d$treatment) <- c('NC', 'NR', 'VC', 'VR')
colnames(d)[1] <- "Treatment"
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
# IAPV (All)
model<-aov(logIAPV~Treatment, data=d)
# Used to print the actual p-values
anova(model)
# IAPV (N vs V)
model<-aov(logIAPV~Virus, data=d)
# Used to print the actual p-values
anova(model)
# IAPV (R vs C)
model<-aov(logIAPV~Diet, data=d)
# Used to print the actual p-values
anova(model)
dev.off()
setwd("~/HoneyBeePaper/Manuscript/Text")
setwd("~/HoneyBeePaper/PathogenResponse")
rm(list=ls())
dev.off()
setwd("~/HoneyBeePaper/PathogenResponse")
library(plyr)
library(ggplot2)
library(multcompView)
library(readr)
library(multcomp)
library(nlme)
d <- read_csv("day3Mortality.csv")
d = as.data.frame(d)
attr(d, "spec") <- NULL
# Note: There are 14 NC; 15 VR, VC, NR
d = d[which(d$Treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$Treatment
d$Treatment = as.factor(d$Treatment)
colnames(d)[3] = "Day3Mortality"
levels(d$Treatment) <- c('NC', 'NR', 'VC', 'VR')
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
mortcomp = lme(Day3Mortality ~ Diet*Virus, data=d, random = ~1|Experiment)
mortcomp2 = lme(Day3Mortality ~ Treatment, data=d, random = ~1|Experiment)
anova(mortcomp)
anova(mortcomp2)
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")))
0.00489*6
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")))
glht(mortcomp2, linfct=mcp(Treatment="Tukey"))
str(summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey"))))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")))[[10]]
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")))[[10]]$pvalues
lme(Day3Mortality ~ Treatment, data=d, random = ~1|Experiment)
anova(mortcomp2)
??glht
str(anova(mortcomp2))
anova(mortcomp2)$p-value
anova(mortcomp2)[["p-value"]]
anova(mortcomp)[["p-value"]]
mortcomp
anova(mortcomp)[["p-value"]]
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")))
anova(mortcomp2)[["p-value"]]
summary(mortcomp2)
summary(anova(mortcomp2))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")))
??lme
anova(mortcomp2)
anova(mortcomp)[["p-value"]]
mortcomp = lmer(Day3Mortality ~ Diet*Virus, data=d, random = ~1|Experiment)
library(lme4)
mortcomp = lmer(Day3Mortality ~ Diet*Virus, data=d, random = ~1|Experiment)
mortcomp <- lmer (Day3Mortality ~ Diet*Virus + (1|Experiment), data = d)
anova(mortcomp)[["p-value"]]
anova(mortcomp)
summary(mortcomp)
summary(glht(mortcomp, linfct = mcp(Group = "Tukey")), test = adjusted("holm"))
mortcomp <- lmer (Day3Mortality ~ Diet*Virus + (1|Experiment), data = d)
summary(glht(mortcomp, linfct = mcp(Group = "Tukey")), test = adjusted("holm"))
mortcomp2 = lme(Day3Mortality ~ Treatment, data=d, random = ~1|Experiment)
summary(glht(mortcomp2, linfct=mcp(Group="Tukey")))
summary(glht(mortcomp, linfct = mcp(Treatment = "Tukey")), test = adjusted("holm"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")))
summary(glht(mortcomp, linfct = mcp(Treatment = "Tukey")), test = adjusted("BH"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
anova(mortcomp)[["p-value"]]
rm(list=ls())
dev.off()
d <- read_csv("day3Mortality.csv")
d = as.data.frame(d)
attr(d, "spec") <- NULL
# Note: There are 14 NC; 15 VR, VC, NR
d = d[which(d$Treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$Treatment
d$Treatment = as.factor(d$Treatment)
colnames(d)[3] = "Day3Mortality"
levels(d$Treatment) <- c('NC', 'NR', 'VC', 'VR')
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
mortcomp = lmer(Day3Mortality ~ Diet*Virus, data=d, random = ~1|Experiment)
mortcomp <- lme(Day3Mortality ~ Diet*Virus + (1|Experiment), data = d)
mortcomp <- lme(Day3Mortality ~ Diet*Virus, data = d, random = ~1|Experiment)
mortcomp2 = lme(Day3Mortality ~ Treatment, data=d, random = ~1|Experiment)
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("bonferroni"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
mortcomp <- lme(Day3Mortality ~ Diet*Virus, data = d, random = ~1|Experiment)
mortcomp
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("bonferroni"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
mortcomp
anova(mortcomp)
str(anova(mortcomp))
str(anova(mortcomp)$p-value)
str(anova(mortcomp)[[p-value]])
str(anova(mortcomp)[["p-value"]])
BONF = p.adjust(anova(mortcomp)[["p-value"]][2:3], "bonferroni")
BONF
p.adjust(anova(mortcomp)[["p-value"]][2:3]
anova(mortcomp)[["p-value"]][2:3]
BONF
p.adjust(anova(mortcomp)[["p-value"]][2:3], "bonferroni")
p.adjust(anova(mortcomp)[["p-value"]][2:3], "BH")
??glht
anova(mortcomp2)
rm(list=ls())
d <- read_delim("logIAPV.csv", "\t", escape_double = FALSE, trim_ws = TRUE)
d = as.data.frame(d)
attr(d, "spec") <- NULL
d = d[which(d$treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$treatment = as.factor(d$treatment)
colnames(d)[3] = "logIAPV"
levels(d$treatment) <- c('NC', 'NR', 'VC', 'VR')
colnames(d)[1] <- "Treatment"
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
mortcomp <- lme(logIAPV ~ Diet*Virus, data = d, random = ~1|Experiment)
mortcomp2 = lme(logIAPV ~ Treatment, data=d, random = ~1|Experiment)
p.adjust(anova(mortcomp)[["p-value"]][2:3], "bonferroni")
p.adjust(anova(mortcomp)[["p-value"]][2:3], "BH")
anova(mortcomp2)
p.adjust(anova(mortcomp2)[["p-value"]][2:3], "bonferroni")
p.adjust(anova(mortcomp2)[["p-value"]][2:3], "BH")
anova(mortcomp2)
rm(list=ls())
d <- read_csv("day3Mortality.csv")
d = as.data.frame(d)
attr(d, "spec") <- NULL
# Note: There are 14 NC; 15 VR, VC, NR
d = d[which(d$Treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$Treatment
d$Treatment = as.factor(d$Treatment)
colnames(d)[3] = "Day3Mortality"
levels(d$Treatment) <- c('NC', 'NR', 'VC', 'VR')
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
mortcomp <- lme(Day3Mortality ~ Diet*Virus, data = d, random = ~1|Experiment)
mortcomp2 = lme(Day3Mortality ~ Treatment, data=d, random = ~1|Experiment)
p.adjust(anova(mortcomp)[["p-value"]][2:3], "bonferroni")
p.adjust(anova(mortcomp)[["p-value"]][2:3], "BH")
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("bonferroni"))
anova(mortcomp2)
rm(list=ls())
dev.off()
d <- read_delim("logIAPV.csv", "\t", escape_double = FALSE, trim_ws = TRUE)
d = as.data.frame(d)
attr(d, "spec") <- NULL
d = d[which(d$treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$treatment = as.factor(d$treatment)
colnames(d)[3] = "logIAPV"
levels(d$treatment) <- c('NC', 'NR', 'VC', 'VR')
colnames(d)[1] <- "Treatment"
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
mortcomp <- lme(logIAPV ~ Diet*Virus, data = d, random = ~1|Experiment)
mortcomp2 = lme(logIAPV ~ Treatment, data=d, random = ~1|Experiment)
p.adjust(anova(mortcomp)[["p-value"]][2:3], "bonferroni")
p.adjust(anova(mortcomp)[["p-value"]][2:3], "BH")
anova(mortcomp2)
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("bonferroni"))
rm(list=ls())
d <- read_delim("logIAPV.csv", "\t", escape_double = FALSE, trim_ws = TRUE)
d = as.data.frame(d)
attr(d, "spec") <- NULL
d = d[which(d$treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$treatment = as.factor(d$treatment)
colnames(d)[3] = "logIAPV"
levels(d$treatment) <- c('NC', 'NR', 'VC', 'VR')
colnames(d)[1] <- "Treatment"
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
mortcomp <- lme(logIAPV ~ Diet*Virus, data = d, random = ~1|Experiment)
mortcomp2 = lme(logIAPV ~ Treatment, data=d, random = ~1|Experiment)
p.adjust(anova(mortcomp)[["p-value"]][2:3], "bonferroni")
p.adjust(anova(mortcomp)[["p-value"]][2:3], "BH")
anova(mortcomp2)
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("bonferroni"))
p.adjust(anova(mortcomp)[["p-value"]][2:3], "BH")
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("bonferroni")
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("bonferroni"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey"), test = adjusted("bonferroni"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("bonferroni"))
glht(mortcomp2, linfct=mcp(Treatment="Tukey"), test = adjusted("bonferroni"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
# IAPV (All)
labelDF = data.frame(plot.labels=c("NR","VC","VR","NC"), labels = c("ab","bc","c","a"), V1 = c(4.25, 5.35, 8.57, 3.85))
plotIAPV = ggplot(d, aes(x=Treatment, y=logIAPV)) + geom_boxplot(fill="paleturquoise2") + geom_text(data = labelDF, size = 8, aes(x = plot.labels, y = V1, label = labels)) + ylab("Log IAPV Titer") +theme_gray() + theme(text=element_text(size=20)) + ylim(2,9)
plotIAPV
plotIAPV = ggplot(d, aes(x=Treatment, y=logIAPV)) + geom_boxplot(fill="paleturquoise2") + geom_text(data = labelDF, size = 6, aes(x = plot.labels, y = V1, label = labels)) + ylab("Log IAPV Titer") +theme_gray() + theme(text=element_text(size=16)) + ylim(2,9)
plotIAPV
dev.off()
dev.off()
d <- read_csv("day3Mortality.csv")
d = as.data.frame(d)
attr(d, "spec") <- NULL
# Note: There are 14 NC; 15 VR, VC, NR
d = d[which(d$Treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$Treatment
d$Treatment = as.factor(d$Treatment)
colnames(d)[3] = "Day3Mortality"
levels(d$Treatment) <- c('NC', 'NR', 'VC', 'VR')
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
mortcomp <- lme(Day3Mortality ~ Diet*Virus, data = d, random = ~1|Experiment)
mortcomp2 = lme(Day3Mortality ~ Treatment, data=d, random = ~1|Experiment)
p.adjust(anova(mortcomp)[["p-value"]][2:3], "bonferroni")
p.adjust(anova(mortcomp)[["p-value"]][2:3], "BH")
anova(mortcomp2)
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("bonferroni"))
# Mortality (All)
labelDF = data.frame(plot.labels=c("NR","VC","VR","NC"), labels = c("ab","bc","c","a"), V1 = c(0.22, 0.479, 0.793, 0.164))
plotMortality = ggplot(d, aes(x=Treatment, y=Day3Mortality)) + geom_boxplot(fill="palegreen2") + geom_text(data = labelDF, size = 8, aes(x = plot.labels, y = V1, label = labels)) + ylab("Day 3 Mortality Rate") + theme_gray() + ylim(0,0.8) + theme(text=element_text(size=20))
plotMortality
plotMortality = ggplot(d, aes(x=Treatment, y=Day3Mortality)) + geom_boxplot(fill="palegreen2") + geom_text(data = labelDF, size = 6, aes(x = plot.labels, y = V1, label = labels)) + ylab("Day 3 Mortality Rate") + theme_gray() + ylim(0,0.8) + theme(text=element_text(size=16))
plotMortality
# Mortality (N vs V)
labelDF = data.frame(plot.labels=c("N","V"), labels = c("a","b"), V1 = c(0.22, 0.52))
plotMortality2 = ggplot(d, aes(x=Virus, y=Day3Mortality)) + geom_boxplot(fill="palegreen2") + geom_text(data = labelDF, size = 6, aes(x = plot.labels, y = V1, label = labels)) + theme_gray() + ylim(0,0.8) +theme(axis.title.y=element_blank(), text=element_text(size=16))
plotMortality2
# Mortality (R vs C)
labelDF = data.frame(plot.labels=c("C","R"), labels = c("a","b"), V1 = c(0.48, 0.54))
plotMortality3 = ggplot(d, aes(x=Diet, y=Day3Mortality)) + geom_boxplot(fill="palegreen2") + geom_text(data = labelDF, size = 6, aes(x = plot.labels, y = V1, label = labels)) + theme_gray() + ylim(0,0.8)+theme(axis.title.y=element_blank(), text=element_text(size=16))
plotMortality3
dev.off()
dev.off()
d <- read_delim("logIAPV.csv", "\t", escape_double = FALSE, trim_ws = TRUE)
d = as.data.frame(d)
attr(d, "spec") <- NULL
d = d[which(d$treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$treatment = as.factor(d$treatment)
colnames(d)[3] = "logIAPV"
levels(d$treatment) <- c('NC', 'NR', 'VC', 'VR')
colnames(d)[1] <- "Treatment"
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
mortcomp <- lme(logIAPV ~ Diet*Virus, data = d, random = ~1|Experiment)
mortcomp2 = lme(logIAPV ~ Treatment, data=d, random = ~1|Experiment)
p.adjust(anova(mortcomp)[["p-value"]][2:3], "bonferroni")
p.adjust(anova(mortcomp)[["p-value"]][2:3], "BH")
anova(mortcomp2)
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
summary(glht(mortcomp2, linfct=mcp(Treatment="Tukey")), test = adjusted("bonferroni"))
# IAPV (N vs V)
labelDF = data.frame(plot.labels=c("N","V"), labels = c("a","b"), V1 = c(4.3, 8.7))
plotIAPV2 = ggplot(d, aes(x=Virus, y=logIAPV)) + geom_boxplot(fill="paleturquoise2") + geom_text(data = labelDF, size = 6, aes(x = plot.labels, y = V1, label = labels)) +theme_gray() + theme(axis.title.y=element_blank(), text=element_text(size=16)) +ylim(2,9)
plotIAPV2
# IAPV (R vs C)
labelDF = data.frame(plot.labels=c("C","R"), labels = c("a","a"), V1 = c(4.3, 8.7))
plotIAPV3 = ggplot(d, aes(x=Diet, y=logIAPV)) + geom_boxplot(fill="paleturquoise2") + geom_text(data = labelDF, size = 6, aes(x = plot.labels, y = V1, label = labels)) +theme_gray() + theme(axis.title.y=element_blank(), text=element_text(size=16)) +ylim(2,9)
plotIAPV3
dev.off()
dev.off()
summary(glht(mortcomp2, test = adjusted("BH"))
)
p.adjust(anova(mortcomp)[["p-value"]][2:3], "bonferroni")
anova(mortcomp2)
summary(anova(mortcomp2))
summary(glht(mortcomp2), test = adjusted("BH"))
str(d)
rep("A",3)
rep("A",10), rep("B", 10), rep("C", 10)
c(rep("A",10), rep("B", 10), rep("C", 10))
rnorm(1)
rnorm(10)
rnorm(0,10)
rnorm(0, 10)
rnorm(10,0)
rep(rep("A",3), rep("B",3), rep("C",3)),3)
rep(rep("A",3), rep("B",3), rep("C",3),3)
rep("A",3)
rep(c(rep("A",3), rep("B",3), rep("C",3)),3)
c(rep("A",9), rep("B",9), rep("C",9))
set.seed(1)
d = as.data.frame(Length = c(rnorm(9,0), rnorm(9,-0.5), rnorm(9,.25)), Drug = c(rep("A",9), rep("B",9), rep("C",9)), Location = rep(c(rep("X",3), rep("Y",3), rep("Z",3)),3))
as.data.frame(Length = c(rnorm(9,0), rnorm(9,-0.5), rnorm(9,.25)))
c(rnorm(9,0), rnorm(9,-0.5), rnorm(9,.25))
d = data.frame(Length = c(rnorm(9,0), rnorm(9,-0.5), rnorm(9,.25)), Drug = c(rep("A",9), rep("B",9), rep("C",9)), Location = rep(c(rep("X",3), rep("Y",3), rep("Z",3)),3))
VIEW(D)
View(d)
d <- read_csv("day3Mortality.csv")
d = as.data.frame(d)
attr(d, "spec") <- NULL
# Note: There are 14 NC; 15 VR, VC, NR
d = d[which(d$Treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$Treatment
d$Treatment = as.factor(d$Treatment)
colnames(d)[3] = "Day3Mortality"
levels(d$Treatment) <- c('NC', 'NR', 'VC', 'VR')
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
str(d)
set.seed(1)
d = data.frame(Length = c(rnorm(9,0), rnorm(9,-0.5), rnorm(9,.25)), Drug = c(rep("A",9), rep("B",9), rep("C",9)), Location = rep(c(rep("X",3), rep("Y",3), rep("Z",3)),3))
str(d)
paste0(c(rep("A",9), rep("B",9), rep("C",9)), rep(c(rep("X",3), rep("Y",3), rep("Z",3)),3))
set.seed(1)
d = data.frame(Length = c(rnorm(9,0), rnorm(9,-0.5), rnorm(9,.25)), Drug = c(rep("A",9), rep("B",9), rep("C",9)), Location = rep(c(rep("X",3), rep("Y",3), rep("Z",3)),3), Treatment = paste0(c(rep("A",9), rep("B",9), rep("C",9)), rep(c(rep("X",3), rep("Y",3), rep("Z",3)),3)))
set.seed(1)
d = data.frame(Length = c(rnorm(9,0), rnorm(9,-0.5), rnorm(9,.25)), Drug = c(rep("A",9), rep("B",9)), Location = rep(c(rep("X",3), rep("Y",3)),3), Treatment = paste0(c(rep("A",9), rep("B",9)), rep(c(rep("X",3), rep("Y",3)),3)))
set.seed(1)
d = data.frame(Length = c(rnorm(9,0), rnorm(9,-0.5)), Drug = c(rep("A",9), rep("B",9)), Location = rep(c(rep("X",3), rep("Y",3)),3), Treatment = paste0(c(rep("A",9), rep("B",9)), rep(c(rep("X",3), rep("Y",3)),3)))
mortcomp2 = lme(Length ~ Treatment, data=d, random = ~1|Experiment)
sample(c(1,2), 18, replace = FALSE)
sample(c(1,2), 18, replace = TRUE)
d = data.frame(Length = c(rnorm(9,0), rnorm(9,-0.5)), Drug = c(rep("A",9), rep("B",9)), Location = rep(c(rep("X",3), rep("Y",3)),3), Treatment = paste0(c(rep("A",9), rep("B",9)), rep(c(rep("X",3), rep("Y",3)),3)), Experiment = sample(c(1,2), 18, replace = TRUE))
mortcomp2 = lme(Length ~ Treatment, data=d, random = ~1|Experiment)
lmeOut = lme(Length ~ Treatment, data=d, random = ~1|Experiment)
lmeOut
summary(glht(lmeOut, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
library(agricolae)
data(sweetpotato)
head(sweetpotato)
View(sweetpotato)
model<-aov(yield~virus, data=sweetpotato)
out <- LSD.test(model,"virus", p.adj="bonferroni")
out
summary(out)
lmeOut = lme(Length ~ Treatment, data=d, random = ~1|Experiment)
summary(glht(lmeOut, linfct=mcp(Treatment="Tukey")), test = adjusted("BH"))
summary(glht(lmeOut, linfct=mcp(Treatment="Tukey")))
rm(list=ls())
set.seed(1)
d = data.frame(Length = c(rnorm(9,0), rnorm(9,-0.5)), Drug = c(rep("A",9), rep("B",9)), Location = rep(c(rep("X",3), rep("Y",3)),3), Treatment = paste0(c(rep("A",9), rep("B",9)), rep(c(rep("X",3), rep("Y",3)),3)), Experiment = sample(c(1,2), 18, replace = TRUE))
# Linear mixed effect model
lmeOut = lme(Length ~ Treatment, data=d, random = ~1|Experiment)
summary(glht(lmeOut, test = adjusted("BH"))
summary(glht(lmeOut), test = adjusted("BH"))
glht(lmeOut), test = adjusted("BH")
library(agricolae)
data(sweetpotato)
model<-aov(yield~virus, data=sweetpotato)
out <- LSD.test(model,"virus", p.adj="benjamini")
out <- LSD.test(model,"virus", p.adj="BH")
out
rm(list=ls())
data(sweetpotato)
model<-aov(yield~virus, data=sweetpotato)
summary(model)
model
out <- LSD.test(model,"virus", p.adj="BH")
out
summary(out)
out
output$comparison
out$comparison
??LSD.test
out <- LSD.test(model,"virus", p.adj="BH", group="TRUE")
out <- LSD.test(model,"virus", p.adj="BH", group=TRUE)
out
rm(list=ls())
dev.off()
d <- read_csv("day3Mortality.csv")
d = as.data.frame(d)
attr(d, "spec") <- NULL
# Note: There are 14 NC; 15 VR, VC, NR
d = d[which(d$Treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$Treatment
d$Treatment = as.factor(d$Treatment)
colnames(d)[3] = "Day3Mortality"
levels(d$Treatment) <- c('NC', 'NR', 'VC', 'VR')
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
mortcomp2 = lme(Day3Mortality ~ Treatment, data=d, random = ~1|Experiment)
anova(mortcomp2)
p.adjust(anova(mortcomp2)[["p-value"]][2:3], "BH")
rm(list=ls())
d <- read_csv("day3Mortality.csv")
d = as.data.frame(d)
attr(d, "spec") <- NULL
# Note: There are 14 NC; 15 VR, VC, NR
d = d[which(d$Treatment %in% c("None Chestnut", "None Rockrose", "Virus Chestnut", "Virus Rockrose")),]
d$Treatment
d$Treatment = as.factor(d$Treatment)
colnames(d)[3] = "Day3Mortality"
levels(d$Treatment) <- c('NC', 'NR', 'VC', 'VR')
d$Virus = sapply(d$Treatment, function(x) substr(x, 1, 1))
d$Diet = sapply(d$Treatment, function(x) substr(x, 2, 2))
d$Virus = as.factor(d$Virus)
d$Diet = as.factor(d$Diet)
mortcomp <- lme(Day3Mortality ~ Diet*Virus, data = d, random = ~1|Experiment)
p.adjust(anova(mortcomp)[["p-value"]][2:3], "BH")
anova(mortcomp2)
mortcomp2 = lme(Day3Mortality ~ Treatment, data=d, random = ~1|Experiment)
d$Treatment
d$Treatment <- relevel(d, ref = "NC")
str(d$Treatment)
d$Treatment <- factor(d$Treatment)
d$Treatment <- relevel(d, ref = "NC")
lmemort1 = lme(Day3Mortality ~ Treatment, data=d, random = ~1|Experiment)
summary(lmemort1)
